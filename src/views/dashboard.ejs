<!DOCTYPE html>
<html lang="es">
<%- include('./partials/head', {title: 'Home | FreeLab' }) %>

<body class="admin__home">

  <%- include('./partials/header') %>
  

  <%- include('./partials/filtroAdmin.ejs') %>
  
  <div class="admin__table-container">
    <table class="admin__table">
      <thead>
        <tr>
          <th class="admin__table__header admin__table__header--id">ID <i class="fa-solid fa-sort"></i></th>
          
          <th class="admin__table__header admin__table__header--nombre">Nombre</th>
          <th class="admin__table__header admin__table__header--email">Descripci√≥n</th>
          <th class="admin__table__header admin__table__header--acciones">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <% switch (optionType) { case 'Empresas': %>
          <% empresas.forEach(e => { %>
            <tr>
              <td><%= e.id %></td>
              <td><%= e.companyName %></td>
              <td><%= e.description %></td>
              <td class="admin__table-cell admin__table-cell--acciones">
                <button class="admin__action-button" onclick="editEmpresa('<%= e.id %>')">Editar</button>
                <button class="admin__action-button" onclick="deleteEmpresa('<%= e.id %>')">Eliminar</button>
              </td>
            </tr>
          <% }) %>
          <% break; case 'Freelancers': %>
            <% freelancers.forEach(f => { %>
              <tr>
                <td><%= f.id %></td>
                <td><%= `${f.firstName} ${f.lastName}` %></td>
                <td></td>
                <td class="admin__table-cell admin__table-cell--acciones">
                  <button class="admin__action-button" onclick="editFreelancer('<%= f.id %>')">Editar</button>
                  <button class="admin__action-button" onclick="deleteFreelancer('<%= f.id %>')">Eliminar</button>
                </td>
              </tr>
            <% }) %>
          <% break; default: %>
            <% projects.forEach(p => { %>
              <tr>
                <td><%= p.id %></td>
                <td><%= p.title %></td>
                <td><%= p.description %></td>
                <td class="admin__table-cell admin__table-cell--acciones">
                  <button class="admin__action-button" onclick="editProject('<%= p.id %>')">Editar</button>
                  <button class="admin__action-button" onclick="deleteProject('<%= p.id %>')">Eliminar</button>
                </td>
              </tr>
            <% }) %>
        <% } %>
      </tbody>
    </table>
  </div>
  
  <div id="details-container" class="admin__details-container">
    <!-- Details of selected item will be displayed here -->
  </div>

  <!--Si se borra este script, no funciona-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <% include('./partials/scripts') %>
  
  <script>
    // Function to sort table by ID
    function sortTableById() {
      const idHeader = document.querySelector('.admin__table__header--id');
      let ascending = true;
    
      idHeader.addEventListener('click', function() {
        const table = document.querySelector('.admin__table');
        const tbody = table.querySelector('tbody');
        const rows = Array.from(tbody.querySelectorAll('tr'));
    
        rows.sort((a, b) => {
          const idA = parseInt(a.cells[0].innerText);
          const idB = parseInt(b.cells[0].innerText);
          return ascending ? idA - idB : idB - idA;
        });
    
        tbody.innerHTML = '';
        rows.forEach(row => tbody.appendChild(row));
        
        ascending = !ascending; // Toggle sorting order
      });
    }
    
    // Initialize function on page load
    window.addEventListener('DOMContentLoaded', function() {
      sortTableById();
    });
    
    
  </script>

</body>

</html>
